<!doctype html>
<html lang="en" itemscope itemtype="http://schema.org/Person">
<head>
            <meta charset="utf-8">
        <!-- Site Meta Data -->
        <title>Fuzzing for Windows (5) - Automation for Drivers</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content="gbaru">

        <link rel="shortcut icon" href="">

        <!-- schema.org -->
        <meta itemprop="name" content="gbaru's blog">
        <meta itemprop="image" content="/theme/images/icons/avatar.png">
        <meta itemprop="description" content="">

        <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700' rel='stylesheet' type='text/css'>
        <!-- Style Meta Data -->
        <link rel="stylesheet" href="https://blog.riskreduction.net/theme/css/style.css" type="text/css"/>
        <link rel="stylesheet" href="https://blog.riskreduction.net/theme/css/pygments.css" type="text/css"/>

        <!-- Feed Meta Data -->
            <link href="https://blog.riskreduction.net/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
                  title="gbaru's blog ATOM Feed"/>

        <!-- Twitter Feed -->
        <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="">
        <meta name="twitter:image" content="">

    <meta name="twitter:creator" content="">
    <meta name="twitter:url" content="https://blog.riskreduction.net/drafts/fuzzing-for-windows-5-automation-for-drivers.html">
    <meta name="twitter:title" content="gbaru's blog ~ Fuzzing for Windows (5) - Automation for Drivers">
    <meta name="twitter:description" content="Whats the Goal 1) We are looking for ways to display all running drivers a) get driver files b) Create a list of known driver to not fuzz the same drivers later 2) Find drivers registered Devices and Symlinks a) Also check access level if anything doesn&#39;t need admin rights …">

    <!-- Facebook Meta Data -->
    <meta property="og:title" content="gbaru's blog ~ Fuzzing for Windows (5) - Automation for Drivers"/>
    <meta property="og:description" content="Whats the Goal 1) We are looking for ways to display all running drivers a) get driver files b) Create a list of known driver to not fuzz the same drivers later 2) Find drivers registered Devices and Symlinks a) Also check access level if anything doesn&#39;t need admin rights …"/>
    <meta property="og:image" content=""/>
</head>

<body>
<!-- Sidebar -->
<aside>
    <center><a href="/theme/images/icons/avatar.png"><img id="avatar" src="/theme/images/icons/avatar.png"></a></center>
    <h1>gbaru's blog</h1>
        <p>Binary Exploitation and Red Teaming</p>
    <br>


    <nav class="nav">
        <ul class="list-bare">

                <li><a class="nav__link" href="/">Articles</a></li>
                <li><a class="nav__link" href="/tags/">Tags</a></li>


        </ul>
    </nav>

    <p class="social">
                <a href="mailto:blog.gbarut@riskreduction.net" target="_blank"><img
                        src="https://blog.riskreduction.net/theme/images/icons/mail-128.png"></a>
                <a href="http://twitter.com/GanbaruTobi" target="_blank"><img
                        src="https://blog.riskreduction.net/theme/images/icons/twitter.png"></a>
                <a href="http://github.com/GanbaruTobi" target="_blank"><img
                        src="https://blog.riskreduction.net/theme/images/icons/github.png"></a>
            <a href="https://blog.riskreduction.net/feeds/all.atom.xml" rel="alternate">
                <img src="https://blog.riskreduction.net/theme/images/icons/rss.png"></a>
    </p>

        <h2>Categories</h2>
        <ul class="navbar">
                <li><a
                        href="https://blog.riskreduction.net/category/fuzzing.html">Fuzzing</a></li>
                <li><a
                        href="https://blog.riskreduction.net/category/general.html">General</a></li>
                <li><a
                        href="https://blog.riskreduction.net/category/misc.html">Misc</a></li>
                <li><a
                        href="https://blog.riskreduction.net/category/pentest.html">Pentest</a></li>
                <li><a
                        href="https://blog.riskreduction.net/category/red.html">Red</a></li>
                <li class="active"><a
                        href="https://blog.riskreduction.net/category/windows.html">Windows</a></li>
                <li><a
                        href="https://blog.riskreduction.net/category/windows-fuzzing.html">windows, fuzzing</a></li>
        </ul>


</aside>

<!-- Content -->
<article>
    <section id="content">
        <article>
            <h2 class="post_title post_detail"><a href="https://blog.riskreduction.net/drafts/fuzzing-for-windows-5-automation-for-drivers.html" rel="bookmark"
                                                  title="Permalink to Fuzzing for Windows (5) - Automation for Drivers">Fuzzing for Windows (5) - Automation for Drivers</a></h2>
            <div class="entry-content blog-post">
                <h2>Whats the Goal</h2>
<p>1) We are looking for ways to display all running drivers
    a) get driver files
    b) Create a list of known driver to not fuzz the same drivers later
2) Find drivers registered Devices and Symlinks
    a) Also check access level if anything doesn't need admin rights
3) Find drivers DeviceIoControl &amp; IOCTL Codes
    a) Find Access Mode of IOCTL to identify FILE_WRITE_DATA
    b) Find Communication Method to identify METHOD_BUFFERED or METHOD_IN_DIRECT
4) Have one Harness that modifies to each driver itself
    a) harness creates breakpoint before the driver function is hit
5) Create snapshot of the VM
6) Identify registers automatically? (Taint?)
7) Fuzz Script that schedules between targets
8) Fuzz</p>
<h2>Display all running Drivers</h2>
<p>We can do this with memflow for qemu, kvm and a coredump</p>
<p><img alt="Running memflow kernel_modul example" src="image.png"></p>
<p>This might even give us options to interact with a target process later, so I will go along with that as part of the solution.</p>
<h3>Get Driver Files</h3>
<h3>Create list of known drivers</h3>
<p>Lets</p>
<h3>Generating Corpus for drivers</h3>
<p>https://github.com/kirasys/ircap</p>
            </div>
            <div class="post_list">
                <span>By </span>
                <a href="https://blog.riskreduction.net/author/gbaru.html">@gbaru</a>
                <span> in </span>
                <span class="post_category"><a href="https://blog.riskreduction.net/category/windows.html" rel="bookmark"
                                               title="Permalink to windows">[ windows ]</a></span>
                <span class="post_date">Di 20 Februar 2024</span>
                <div><span>Tags : </span>
                            <span><a href="https://blog.riskreduction.net/tag/windows.html">#windows, </a></span>
                            <span><a href="https://blog.riskreduction.net/tag/fuzzing.html">#fuzzing, </a></span>
                </div>

            </div>
        </article>
    </section>
</article>

<!-- Footer -->
    <footer>
        <p>
        </p>
    </footer>


</body>
</html>